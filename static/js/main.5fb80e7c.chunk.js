(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{139:function(e,t,c){},140:function(e,t,c){},141:function(e,t,c){},164:function(e,t,c){},263:function(e,t,c){},264:function(e,t,c){},267:function(e,t,c){},268:function(e,t,c){},269:function(e,t,c){},272:function(e,t,c){"use strict";c.r(t);var s=c(0),a=c.n(s),n=c(114),r=c.n(n),i=(c(139),c(140),c(21)),o=c(4),l=c(5),j=(c(141),c(26)),u=c(117),m=c.n(u).a.create({baseURL:"https://rcmessneger.herokuapp.com/api"}),d=c(1);var b=function(){var e=Object(s.useState)(""),t=Object(l.a)(e,2),c=t[0],a=t[1],n=Object(s.useState)(""),r=Object(l.a)(n,2),u=r[0],b=r[1],h=Object(o.g)();return Object(d.jsxs)("div",{className:"login",children:[Object(d.jsx)("div",{className:"login__title",children:Object(d.jsx)("h3",{children:"Hi Lets get started"})}),Object(d.jsxs)("div",{className:"login__content",children:[Object(d.jsx)("h3",{children:"Login"}),Object(d.jsx)(j.c,{initialValues:{username:"",password:"",rememberMe:!1},children:Object(d.jsxs)("form",{className:"login__form",children:[Object(d.jsx)("input",{type:"text",className:"form-control login__input",placeholder:"username",value:c,onChange:function(e){return a(e.target.value)}}),Object(d.jsx)("input",{type:"password",className:"form-control login__input",placeholder:"password",value:u,onChange:function(e){return b(e.target.value)}}),Object(d.jsxs)("div",{className:"form-check login__checkbox",children:[Object(d.jsx)("label",{htmlFor:"remember",className:"form-check-label",children:"remember my login"}),Object(d.jsx)("input",{type:"checkbox",name:"rememberMe",className:"form-check-input "})]}),Object(d.jsx)("button",{className:"btn btn-primary",onClick:function(e){e.preventDefault(),m.post("/account/login",{username:c,password:u}).then((function(e){console.log(e.data),e.data.token&&(localStorage.setItem("user",JSON.stringify(e.data)),h("/messenger",{replace:!0}),window.location.reload())})).catch((function(e){return console.log(e)}))},children:"Login"})]})}),Object(d.jsx)("div",{className:"login__footer",children:Object(d.jsx)(i.b,{to:"/messenger/account/register",children:Object(d.jsx)("h3",{children:"create an account"})})})]})]})},h=c(79),O=c.n(h),x=c(118),g=(c(164),c(38));var f=function(){var e=Object(o.g)(),t=g.a().shape({username:g.c().required("Username required").min(6,"username should be atleast 6 character"),password:g.c().required("Password required").min(8,"password should be 8 character"),repeatPassword:g.c().oneOf([g.b("password"),null],"Passwords must match"),email:g.c().email("this is not in email format").required()}),c=function(){var t=Object(x.a)(O.a.mark((function t(c){return O.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,m.post("/account/register",{username:c.username,password:c.password,email:c.email}).then((function(t){alert("you succesfully registred"),e("/messenger",{replace:!0})})).catch((function(e){return alert(e)}));case 2:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}();return Object(d.jsxs)("div",{className:"register",children:[Object(d.jsx)("div",{className:"register__title",children:Object(d.jsx)("h3",{children:"Hi Lets get started"})}),Object(d.jsxs)("div",{className:"register__content",children:[Object(d.jsx)("h3",{children:"Register"}),Object(d.jsx)(j.c,{initialValues:{username:"",email:""},validationSchema:t,onSubmit:c,children:function(e){var t=e.errors,c=e.touched;return Object(d.jsxs)(j.b,{className:"register__form",children:[Object(d.jsx)(j.a,{name:"username",className:"form-control register__input",placeholder:"username"}),c.username&&t.username&&Object(d.jsx)("p",{className:"text-danger",children:t.username}),Object(d.jsx)(j.a,{name:"password",className:"form-control register__input",placeholder:"password"}),c.password&&t.password&&Object(d.jsx)("p",{className:"text-danger",children:t.password}),Object(d.jsx)(j.a,{name:"repeatPassword",placeholder:"repeat password",className:"form-control register__input"}),c.repeatPassword&&t.repeatPassword&&Object(d.jsx)("p",{className:"text-danger",children:t.repeatPassword}),Object(d.jsx)(j.a,{name:"email",className:"form-control register__input",placeholder:"email"}),c.email&&t.email&&Object(d.jsx)("p",{className:"text-danger",children:t.email}),Object(d.jsx)("button",{type:"submit",className:"btn btn-danger",children:"Submit"})]})}}),Object(d.jsx)("div",{className:"register__footer",children:Object(d.jsx)(i.b,{to:"/messenger/account/login",children:Object(d.jsx)("h3",{children:"sign in"})})})]})]})},p=(c(263),c(264),c(62)),v=c.n(p);var _=function(e){var t=e.contactName,c=Object(o.g)(),a=Object(s.useState)(""),n=Object(l.a)(a,2),r=n[0],i=n[1],j=Object(s.useState)(""),u=Object(l.a)(j,2),b=u[0],h=u[1],O=JSON.parse(localStorage.getItem("user"));return Object(s.useEffect)((function(){m.post("/message/sync",{user1:O.username,user2:t}).then((function(e){var t=e.data.length,c=e.data[t-1];return i(c.message)})).catch((function(e){console.log(e)}))}),[]),Object(s.useEffect)((function(){m.get("/account/".concat(t)).then((function(e){var t=e.data.avatar;return h(t)})).catch((function(e){console.log(e)}))}),[]),Object(d.jsxs)("div",{className:"contactItem",onClick:function(){c("/messenger/".concat(t))},children:[Object(d.jsxs)("div",{className:"contactItem__avatar",children:[" ",b?Object(d.jsx)("img",{src:b,alt:""}):Object(d.jsx)(v.a,{})," "]})," ",Object(d.jsxs)("div",{className:"contactItem__msg",onClick:function(){var e=document.getElementById("right"),t=document.getElementById("left");e.classList.add("right__click"),t.classList.add("left__click")},children:[Object(d.jsxs)("h5",{children:[" ",t," "]})," ",Object(d.jsxs)("p",{children:[" ",r," "]})," "]})," "]})},N=(c(267),c(126)),w=c.n(N),S=c(287),I=c(125),k=c.n(I),y=c(124),L=c(127),C=c.n(L),E=c(128),P=c.n(E);var B=function(){var e=Object(s.useRef)(),t=Object(s.useState)([]),c=Object(l.a)(t,2),a=c[0],n=c[1],r=Object(s.useState)(""),i=Object(l.a)(r,2),o=i[0],j=i[1],u=Object(s.useState)(!1),b=Object(l.a)(u,2),h=b[0],O=b[1],x=JSON.parse(localStorage.getItem("user"));return Object(s.useEffect)((function(){m.get("/account/contacts/".concat(x.username)).then((function(e){n(e.data)})).catch((function(e){console.log(e)}))}),[]),Object(d.jsxs)("div",{className:"contacts",children:[Object(d.jsxs)("div",{className:"contacts__header",children:[Object(d.jsxs)("div",{className:"contacts__selfInfo",children:[Object(d.jsx)("img",{className:"contacts_selfInfoImage",src:x.avatar,alt:""}),Object(d.jsx)("p",{className:"contacts_selfInfoName",children:x.username})]}),Object(d.jsxs)("div",{className:"contacts__selfOptions",children:[Object(d.jsx)(S.a,{color:"inherit",onClick:function(){O(!0)},children:Object(d.jsx)(k.a,{})}),Object(d.jsx)(S.a,{color:"inherit",children:Object(d.jsx)(w.a,{className:"settingsIcon"})}),Object(d.jsx)(S.a,{color:"inherit",onClick:function(){localStorage.removeItem("user"),window.location.reload()},children:Object(d.jsx)(C.a,{})})]})]}),h&&Object(d.jsxs)("div",{className:"contacts__contactInput",children:[Object(d.jsx)(S.a,{color:"inherit",onClick:function(){return O(!1)},children:Object(d.jsx)(P.a,{})}),Object(d.jsxs)("form",{action:"",children:[Object(d.jsx)("input",{type:"text",placeholder:"contact name",value:o,ref:e,onChange:function(e){return j(e.target.value)}}),Object(d.jsx)("button",{type:"submit",onClick:function(e){e.preventDefault(),m.post("/account/contacts/".concat(x.username),{contactName:o}).then((function(e){alert("Contact added"),window.location.reload()})).catch((function(e){return alert(e)})),O(!1)}})]})]}),Object(d.jsx)(y.a,{className:"contacts__content",hideScrollbars:!1,children:a.map((function(e){return Object(d.jsx)(_,{contactName:e.name,avatar:""},e._id)}))})]})},J=c(7),q=(c(268),c(130)),F=c.n(q),D=c(131),H=c.n(D),R=c(82),M=c.n(R);c(269);var T=function(e){var t=e.receiver,c=e.timestamp,s=e.msg,a=Object(o.h)(),n=JSON.parse(localStorage.getItem("user"));return t!==n.username?Object(d.jsx)("div",{className:"msg",children:Object(d.jsxs)("div",{className:"bubble alt",children:[Object(d.jsxs)("div",{className:"txt",children:[Object(d.jsxs)("div",{className:"txt__wrap",children:[Object(d.jsx)("span",{className:"name alt",children:n.username}),Object(d.jsx)("span",{className:"timestamp",children:c})]}),Object(d.jsx)("p",{className:"message",children:s})]}),Object(d.jsx)("div",{className:"bubble-arrow alt"})]})}):Object(d.jsx)("div",{className:"msg",children:Object(d.jsxs)("div",{className:"bubble",children:[Object(d.jsxs)("div",{className:"txt",children:[Object(d.jsxs)("div",{className:"txt__wrap",children:[Object(d.jsx)("span",{className:"name",children:a.user}),Object(d.jsx)("span",{className:"timestamp",children:c})]}),Object(d.jsx)("span",{className:"message",children:s})]}),Object(d.jsx)("div",{className:"bubble-arrow"})]})})},U=c(129),V=c.n(U);var A=function(){var e=Object(o.h)(),t=Object(s.useState)(""),c=Object(l.a)(t,2),a=c[0],n=c[1],r=Object(s.useState)([]),i=Object(l.a)(r,2),j=i[0],u=i[1],b=Object(s.useState)(""),h=Object(l.a)(b,2),O=h[0],x=h[1],g=JSON.parse(localStorage.getItem("user"));return Object(s.useEffect)((function(){m.post("/message/sync",{user1:g.username,user2:e.user}).then((function(e){u(e.data)})).catch((function(e){return console.log(e)}))}),[e]),Object(s.useEffect)((function(){m.get("/account/".concat(e.user)).then((function(e){var t=e.data.avatar;return x(t)})).catch((function(e){console.log(e)}))}),[e]),Object(s.useEffect)((function(){var t=new V.a("eba934b1dbc8ba404bcb",{cluster:"eu"}).subscribe("messages");return t.bind("updated",(function(t){m.post("/message/sync",{user1:g.username,user2:e.user}).then((function(e){u(e.data)})).catch((function(e){return console.log(e)})),console.log("hello")})),function(){t.unbind_all(),t.unsubscribe()}}),[j]),Object(d.jsxs)("div",{className:"chat",children:[Object(d.jsxs)("div",{className:"chat__header",id:"chatHeader",children:[Object(d.jsxs)("div",{className:"chat__headerLeftPart",children:[Object(d.jsx)(F.a,{id:"backButton",onClick:function(){var e=document.getElementById("right"),t=document.getElementById("left"),c=document.getElementById("backButton"),s=document.getElementById("chatHeader");e.classList.remove("right__click"),t.classList.remove("left__click"),c.classList.remove("buttonShow"),s.classList.remove("show")}}),Object(d.jsx)("div",{className:"chat__contactAvatar",children:O?Object(d.jsx)("img",{src:O,alt:""}):Object(d.jsx)(v.a,{})})]}),Object(d.jsx)("div",{className:"chat__headerRightPart",children:Object(d.jsx)("h2",{children:e.user})})]}),Object(d.jsxs)("div",{className:"chat__content",children:[Object(d.jsx)("div",{className:"chat__contentPart",children:j.map((function(e,t){return Object(d.jsx)(T,{receiver:e.receiver,timestamp:e.timestamp,msg:e.message},t)}))}),Object(d.jsxs)("form",{className:"chat__contentInput",onSubmit:function(t){t.preventDefault(),m.post("/message/send",{senderName:g.username,receiverName:e.user,message:a,timestamp:M()().format("LLL")}).catch((function(e){return console.log(e)})),u([].concat(Object(J.a)(j),[{name:g.username,timestamp:M()().format("LLL"),message:a,receiver:e.user}])),n("")},children:[Object(d.jsx)("input",{type:"text",className:"chat__input",value:a,onChange:function(e){n(e.target.value)}}),Object(d.jsxs)("button",{type:"submit",children:[Object(d.jsx)(H.a,{})," "]})]})]})]})};var z=function(){var e=Object(o.h)();return JSON.parse(localStorage.getItem("user"))?Object(d.jsxs)("div",{className:"main",id:"main",children:[Object(d.jsx)("div",{className:"main__left",id:"left",children:Object(d.jsx)(B,{})}),Object(d.jsx)("div",{className:"main__right",id:"right",children:e.user?Object(d.jsx)(A,{}):Object(d.jsx)("h1",{children:"select a chat to start"})})]}):Object(d.jsx)(o.a,{to:"/messenger/account/login"})};var G=function(){return Object(d.jsx)(i.a,{children:Object(d.jsx)("div",{className:"app",children:Object(d.jsxs)(o.d,{children:[Object(d.jsx)(o.b,{path:"/messenger",element:Object(d.jsx)(z,{}),children:Object(d.jsx)(o.b,{path:"/messenger/:user"})}),Object(d.jsx)(o.b,{path:"/messenger/account/login",element:Object(d.jsx)(b,{})}),Object(d.jsx)(o.b,{path:"/messenger/account/register",element:Object(d.jsx)(f,{})})]})})})},K=function(e){e&&e instanceof Function&&c.e(3).then(c.bind(null,289)).then((function(t){var c=t.getCLS,s=t.getFID,a=t.getFCP,n=t.getLCP,r=t.getTTFB;c(e),s(e),a(e),n(e),r(e)}))};c(270);r.a.render(Object(d.jsx)(a.a.StrictMode,{children:Object(d.jsx)(G,{})}),document.getElementById("root")),K()}},[[272,1,2]]]);
//# sourceMappingURL=main.5fb80e7c.chunk.js.map